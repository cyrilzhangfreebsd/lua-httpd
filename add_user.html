<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Install FreeBSD</title>
		<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.2/css/bulma.min.css">
			<link rel="stylesheet" href="https://unpkg.com/bulmaswatch/{{theme}}/bulmaswatch.min.css"> -->
	</head>
	<body>
		<script>

			function checkPassword () {
				if (document.getElementById("password").value ===
					document.getElementById("confirm_password").value) {
					document.getElementById("message").innerHTML = "Passwords match!";
					document.getElementById("submitbutton").disabled = false;
				} else {
					document.getElementById("message").innerHTML = "Passwords don't match";
					document.getElementById("submitbutton").disabled = true;
				}
			}
			function checkUsername (e) {
				//TODO write this function.
			}
			function startup () {
				let password = document.getElementById("password");
				password.addEventListener("input", checkPassword);

				let confirm_password = document.getElementById("confirm_password");
				confirm_password.addEventListener("input", checkPassword);

				let username = document.getElementById("username");
				username.addEventListener("input", checkUsername);
			}
			window.addEventListener("load", startup);

		</script>
		<div class="columns is-centered">
			<div class="column is-narrow">

				<h1 class="title">Add User</h1>

				<form action="/adduser" method="POST">

					<div class="field">
						<label>
							Username:
							<input class="input" type="text" id = "username" name="username" required value = "{{orEmpty(username)}}" {{readonly(editing)}}
							    placeholder="username" pattern="^[a-z_]([a-z0-9_-]{0,31}|[a-z0-9_-]{0,30}\$)$">
						</label>
					</div>

					<div class="field">
						<label>
							Real name:
							<input class="input" type="text" name="full_name"
							    placeholder="real name" value="{{orEmpty(full_name)}}" required>
						</label>
					</div>

					<div class="field">
						<label>
							Additional groups:
							<input class="input" type="text" name="groups"
							 placeholder="additional groups" value="{{orWheel(groups)}}">
						</label>
					</div>

					<div class="field">
						<label>
							Shell:
							<div class="select">
								<select name="shell">
									{% for _, shell in ipairs(shells) do %}
									<option value="{{shell}}" {{selected(shell == user_shell)}}>{{shell}}</option>
									{% end %}
								</select>
							</div>
						</label>
					</div>

					<div class="field">
						<label>
							Password:
							<input class="input" type="password" name="password" id="password"
						            placeholder="password" required>
						</label>
					</div>

					<div class="field">
						<label>
							Confirm password:
							<input class="input" type="password" name="confirm_password" id="confirm_password"
							    placeholder="confirm password" required>
						</label>
					</div>
					<span id="message"></span>
					<div class="field">
						<div class="control">
							<input id="submitbutton" class="button is-primary" type="submit" value="Apply" disabled>
						</div>
					</div>
				</form>
			</div>
		</div>
	</body>
</html>
